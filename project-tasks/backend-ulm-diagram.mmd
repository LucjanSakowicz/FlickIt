flowchart TD
  A1(["POST /users (CreateUserRequest)"]) --> A2(["UserService.create"])
  A2 --> A3(["UserRepository.save"])
  A2 --> A4(["UserDto"])
  B1(["GET /users/{id}"]) --> B2(["UserService.getById"])
  B2 --> B3(["UserRepository.findById"])
  B2 --> B4(["UserDto"])
  C1(["GET /users/me"]) --> C2(["AuthContext.getCurrentUser"])
  C2 --> C3(["UserService.getById"])

  D1(["POST /auth/login (UserLoginRequest)"]) --> D2(["UserService.login"])
  D2 --> D3(["UserRepository.findByPhone"])
  D2 --> D4(["BCryptPasswordEncoder"])
  D2 --> D5(["JwtService.generateToken"])
  D5 --> D6(["JWT"])
  E1(["POST /auth/token"]) --> E2(["JwtService.generateToken"])
  F1(["POST /auth/test-token"]) --> F2(["JwtService.generateToken"])

  G1(["GET /events"]) --> G2(["EventService.getAllEvents"])
  G2 --> G3(["EventRepository.findAll"])
  G2 --> G4(["EventDto"])
  H1(["GET /events/{id}"]) --> H2(["EventService.getEventById"])
  H2 --> H3(["EventRepository.findById"])
  H2 --> H4(["EventDto"])
  I1(["POST /events (EventDto)"]) --> I2(["EventService.createEvent"])
  I2 --> I3(["EventRepository.save"])
  I2 --> I4(["EventDto"])

  J1(["POST /claims (ClaimEventRequest)"]) --> J2(["ClaimService.claimEvent"])
  J2 --> J3(["ClaimRepository.existsById"])
  J2 --> J4(["ClaimRepository.save"])
  K1(["POST /claims/rate (RateEventRequest)"]) --> K2(["ClaimService.rateEvent"])
  K2 --> K3(["ClaimRepository.findById"])
  K2 --> K4(["ClaimRepository.save"])

  L1(["POST /ratings (CreateRatingRequest)"]) --> L2(["RatingService.rateEvent"])
  L2 --> L3(["AuthContext.getCurrentUser"])
  L2 --> L4(["RatingRepository.existsByEventIdAndUserId"])
  L2 --> L5(["RatingRepository.save"])
  L2 --> L6(["UserRepository.findById"])
  L2 --> L7(["EventRepository.findById"])
  L2 --> L8(["RatingDto"])

  M1(["SecurityConfig"]) --> M2(["JwtAuthenticationFilter"])
  M2 --> M3(["JwtService"])
  M2 --> M4(["UserRepository"])
  M2 --> M5(["AuthContext"]) 